:root {
  color-scheme: light dark;
  --bg: #0f1115; --fg: #e8eaf0; --muted: #9aa4b2;
  --card: #171a21; --border: #2a2f3a;
  --accent: #2dd4bf; --accent2: #ffd166; --warn: #ffb000; --danger:#d33;
  --vh: 1vh;
}

* { box-sizing: border-box; font-family: Inter, ui-sans-serif, system-ui, Segoe UI, Roboto, Arial; }
body { margin: 0; background: var(--bg); color: var(--fg); }

header { display: flex; align-items: center; gap: 16px; padding: 12px 16px; border-bottom: 1px solid var(--border); }
h1 { font-size: 18px; margin: 0 8px 0 0; }
.controls { display: flex; gap: 10px; align-items: center; flex-wrap: wrap; }
.controls label { display: flex; gap: 8px; align-items: center; color: var(--muted); }
select, input[type="range"], button, input[type="text"] {
  padding: 6px 10px; border: 1px solid var(--border); background: var(--card); color: var(--fg); border-radius: 8px;
}
button { cursor: pointer; }
button.danger { border-color: var(--danger); color: #ffd3d3; }

main {
  display: grid;
  grid-template-columns: 1fr 360px;
  gap: 16px;
  padding: 16px;
}

/* Stage / Canvas */
.stage { position: relative; display: grid; gap: 8px; }
#padWrap {
  width: 100%;
  aspect-ratio: 16 / 9;
  max-height: calc(var(--vh) * 70);
  min-height: 320px;
}
@media (orientation: portrait) {
  #padWrap { aspect-ratio: 3 / 4; max-height: calc(var(--vh) * 60); }
}
#pad {
  width: 100%; height: 100%;
  border: 2px dashed var(--border);
  border-radius: 12px;
  background: #0c0f14;
  touch-action: none;
}

/* HUD */
.hud { position: absolute; inset: 10px 10px auto auto; display: flex; gap: 8px; align-items: center; pointer-events: none; }
.timer, .stars { background: rgba(0,0,0,0.35); padding: 6px 10px; border-radius: 8px; border: 1px solid var(--border); }
.stars { letter-spacing: 4px; }

/* Sidebar */
aside { display: grid; gap: 12px; }
.card { background: var(--card); border: 1px solid var(--border); padding: 12px; border-radius: 12px; }
.card h3 { margin: 0 0 6px; }
.big { font-size: 48px; font-weight: 800; color: var(--accent); }
.meta { color: var(--muted); display: grid; gap: 4px; margin-top: 8px; }
.small { margin: 0; padding-left: 18px; color: var(--muted); }

/* Template sharing UI */
.share { display: grid; gap: 8px; }
.row { display: flex; gap: 8px; align-items: center; flex-wrap: wrap; }
.row > button { flex: 1 1 auto; }
.row > input[type="text"] { flex: 1 1 220px; }
.muted { color: var(--muted); }
code { color: var(--accent2); }

/* Math panel */
.mono {
  font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace;
  font-size: 12px; line-height: 1.35; white-space: pre-wrap; color: var(--muted);
}

footer { border-top: 1px solid var(--border); padding: 10px 16px; color: var(--muted); }

/* Responsive: collapse sidebar under canvas */
@media (max-width: 1100px) {
  main { grid-template-columns: 1fr; }
  aside { order: 2; }
  .stage { order: 1; }
  #padWrap { max-height: calc(var(--vh) * 70); }
}
